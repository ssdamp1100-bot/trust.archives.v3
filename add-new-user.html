<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ø§Ø±Ø´ÙŠÙ Ø§Ù„Ø«Ù‚Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</title>
    
	 <!-- Google fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhaijaan+2:wght@400..800&family=Noto+Naskh+Arabic:wght@400..700&family=Noto+Sans+Arabic:wght@100..900&family=Vazirmatn:wght@100..900&display=swap" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400..700&display=swap" rel="stylesheet">
    
	
	
	 <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	
	<!-- css Stylesheet -->
    <link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/add-new-user.css">
    <style>
        
    </style>
</head>
 <body class="theme1"> 
  <script>
    (function(){
      try{
        var savedTheme = localStorage.getItem('selectedTheme');
        if(savedTheme){ document.body.className = savedTheme; }
      }catch(e){}
    })();
  </script>
 <!-- Ø²Ø± ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ… -->
    <button class="change-theme" id="theme-toggle">
     <i class="fa-solid fa-palette"></i>
    </button>
    <div class="section" id="home">
        
<!-- Registration Modal -->
<div id="registerModal" class="modal">
    <div class="modal-content add-modal-content">
        <button class="modal-close" onclick="window.location.href='admin.html'">&times;</button>
        <h3 class="modal-title">ğŸ“ ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯</h3>
        
        <form id="registerForm" class="modal-add-form">
            <div class="modal-form-grid">
                <div class="modal-form-group">
                    <label for="registerName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label>
                    <input type="text" id="registerName" required  >
                </div>
                
                <div class="modal-form-group">
                    <label for="registerCountry">Ø§Ù„Ø¨Ù„Ø¯ *</label>
                    <input type="text" id="registerCountry" required  >
                </div>
            </div>
            
            <div class="modal-form-grid">
                <div class="modal-form-group">
                    <label for="registerAge">Ø§Ù„Ø¹Ù…Ø± *</label>
                    <input type="number" id="registerAge" required placeholder="25" min="16" max="100">
                </div>
                
                <div class="modal-form-group">
                    <label for="registerResidence">Ø§Ù„Ø³ÙƒÙ† *</label>
                    <input type="text" id="registerResidence" required  >
                </div>
            </div>
			
             <div class="modal-form-grid">
                <div class="modal-form-group">
                    <label for="registerResidence">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *</label>
                    <input type="text" id="username" placeholder="Ø¨Ø§Ù„Ø§Ø­Ø±Ù Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©" required  >
                </div>
				 <div class="modal-form-group">
                    <label for="registerAge">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± *</label>
                    <input type="text" id="userpassword" required placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>
            </div>
            
            <div class="modal-form-grid">
                <div class="modal-form-group">
                    <label for="userRole">Ø§Ù„Ø¯ÙˆØ± *</label>
                    <select id="userRole" required>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±</option>
                        <option value="member">Ø¹Ø¶Ùˆ</option>
                        <option value="admin">Ù…Ø¯ÙŠØ±</option>
                    </select>
                </div>
            </div>
			
			
            <div class="modal-image-group">
                <label for="registerPhoto">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©</label>
                <input type="file" id="registerPhoto" accept="image/*">
            </div>
            
            <div class="contact-section">
                <h4 class="section-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„</h4>
                
                <div class="dynamic-fields" id="registerPhoneFields">
                    <label>Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‡ÙˆØ§ØªÙ *</label>
                    <div class="field-group">
                        <input type="tel" placeholder="+966 50 123 4567" class="phone-input" required>
                        <button type="button" onclick="addRegisterPhoneField()" class="add-field-btn"><i class="fa fa-plus" aria-hidden="true"></i></button>
                    </div>
                </div>
                
                <div class="dynamic-fields">
                    <label for="registerWhatsapp">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ *</label>
                    <input type="tel" id="registerWhatsapp" required placeholder="+966 50 123 4567">
                </div>
                
                <div class="dynamic-fields">
                    <label for="registerEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                    <input type="email" id="registerEmail" required placeholder="example@email.com">
                </div>
                
                <div class="dynamic-fields">
                    <label for="registerOtherContact">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                    <textarea id="registerOtherContact"  rows="2"></textarea>
                </div>
            </div>
            
            <div class="modal-form-actions">
                <button type="submit" class="login-btn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</button>
                <button type="button" onclick="closeRegisterModal()" class="cancel-btn">Ø¥Ù„ØºØ§Ø¡</button>
				<button type="button" onclick="window.location.href='admin.html'" class="login-btn">Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø§Ù„Ù‰ ØµÙ‚Ø­Ø© Ø§Ù„Ø§Ø¯Ø§Ø±Ø©</button>
            </div>
        </form>
    </div>
</div>
             
      
          
 

<!-- JavaScript Ø§Ù„Ø¨Ø³ÙŠØ· Ù„Ù„Ù€ Modal (ÙŠÙ…ÙƒÙ† ÙˆØ¶Ø¹Ù‡ ÙÙŠ <script> tag ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø©) -->
<script>
function showRegisterModal() {
    document.getElementById('registerModal').style.display = 'block';
}

function closeRegisterModal() {
    document.getElementById('registerModal').style.display = 'none';
}

// Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø¥Ø¶Ø§ÙØ© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù‡Ø§ØªÙ (ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠØŒ ÙŠÙ…ÙƒÙ† ØªØ®ØµÙŠØµÙ‡Ø§)
function addRegisterPhoneField() {
    const container = document.getElementById('registerPhoneFields');
    const newField = document.createElement('div');
    newField.className = 'field-group';
    newField.innerHTML = `
        <input type="tel" placeholder="+966 50 123 4567" class="phone-input" required>
        <button type="button" onclick="this.parentElement.remove()" class="add-field-btn">-</button>
    `;
    container.appendChild(newField);
}
</script>

    <!-- Include Supabase and services -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/auth-service.js"></script>
    <script>
      (function(){
        document.addEventListener('DOMContentLoaded', function(){
          try{
            if (!window.authService || !window.authService.isLoggedIn()) {
              window.location.href = 'index.html';
              return;
            }
            const me = window.authService.getCurrentUser();
            if (!me || me.role !== 'admin') {
              alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©');
              window.location.href = 'dashboard.html';
              return;
            }
          }catch(e){ console.warn('admin guard error:', e); }
        });
      })();
    </script>
    <script src="js/add-user-logic.js"></script>
    
    <script>

// Login form handling (static version, unchanged as it's separate from modal)
document.getElementById('loginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const btnText = document.querySelector('.btn-text');
    const loading = document.querySelector('.loading');
    const message = document.getElementById('loginMessage');
    
    // Show loading
    btnText.classList.add('hidden');
    loading.classList.remove('hidden');
    message.classList.add('hidden');
    
    // Simulate login process
    setTimeout(() => {
        if (username.trim() && password.trim()) {
            // Check demo credentials
            if ((username === 'admin' && password === 'admin') || 
                (username === 'Ø³Ø§Ø±Ø©_Ø§Ù„ØªØ³ÙˆÙŠÙ‚' && password === 'sara123') ||
                (username === 'Ù…Ø­Ù…Ø¯_Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª' && password === 'mohamed123')) {
                
                // Redirect based on username
                if (username === 'admin') {
                    window.location.href = 'admin.html';
                } else {
                    window.location.href = 'dashboard.html';
                }
            } else {
                message.textContent = 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©. Ø¬Ø±Ø¨: admin/admin';
                message.className = 'message error';
                message.classList.remove('hidden');
                
                btnText.classList.remove('hidden');
                loading.classList.add('hidden');
            }
        } else {
            message.textContent = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
            message.className = 'message error';
            message.classList.remove('hidden');
            
            btnText.classList.remove('hidden');
            loading.classList.add('hidden');
        }
    }, 1000);
});

// Registration Modal Functions (updated to use display: block/none for compatibility with new CSS)
function showRegisterModal() {
    document.getElementById('registerModal').style.display = 'block';
}

function closeRegisterModal() {
    const modal = document.getElementById('registerModal');
    modal.style.display = 'none';
    document.getElementById('registerForm').reset();
    // Reset dynamic phone fields
    const phoneFields = document.getElementById('registerPhoneFields');
    const extraFields = phoneFields.querySelectorAll('.field-group:not(:first-child)');
    extraFields.forEach(field => field.remove());
}

// Updated addRegisterPhoneField to match new HTML/JS structure (uses inline remove for simplicity)
function addRegisterPhoneField() {
    const phoneFields = document.getElementById('registerPhoneFields');
    const newField = document.createElement('div');
    newField.className = 'field-group';
    newField.innerHTML = `
        <input type="tel" placeholder="+966 50 123 4567" class="phone-input" required>
        <button type="button" onclick="this.parentElement.remove()" class="add-field-btn" style="background: #e53e3e;">-</button>
    `;
    phoneFields.appendChild(newField);
}

// Remove the separate removeField function as it's now inline (simplifies code)

// Form submission is now handled by add-user-logic.js

// Message display function (unchanged)
function showMessage(message, type = 'success') {
    const messageEl = document.getElementById('loginMessage') || document.createElement('div');
    messageEl.textContent = message;
    messageEl.className = `message ${type}`;
    messageEl.classList.remove('hidden');
    
    // Auto hide after 3 seconds
    setTimeout(() => {
        messageEl.classList.add('hidden');
    }, 3000);
}

// Close modal on backdrop click (updated to use display: none)
document.getElementById('registerModal').addEventListener('click', function(e) {
    if (e.target === this) closeRegisterModal();
});

// Add styles for quick login buttons (updated to match new theme colors for consistency)
const style = document.createElement('style');
style.textContent = `
    .quick-login-btn {
        background: rgba(102, 126, 234, 0.2); /* Updated to match new theme */
        border: 1px solid #667eea;
        color: #667eea;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.3s ease;
        flex: 1;
    }
    .quick-login-btn:hover {
        background: rgba(102, 126, 234, 0.3);
        color: white;
    }
`;
document.head.appendChild(style);
    </script>
	<script src="js/theme.js"></script>
</body>
</html>
